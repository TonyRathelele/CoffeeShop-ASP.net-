@using Microsoft.AspNetCore.Http.Features

@{
    var consentFeature = Context.Features.Get<ITrackingConsentFeature>();
    var showBanner = !consentFeature?.CanTrack ?? false;
    var cookieString = consentFeature?.CreateConsentCookie();
}

@if (showBanner)
{
    <div id="cookieConsent" class="alert alert-info alert-dismissible fade show position-fixed bottom-0 start-0 end-0 m-3" role="alert" style="z-index: 1050;">
        <div class="d-flex align-items-center">
            <div class="flex-grow-1">
                <i class="fas fa-cookie-bite me-2"></i>
                <strong>We use cookies</strong> to enhance your experience and analyze site usage. 
                <a asp-controller="Home" asp-action="Privacy" class="alert-link">Learn more</a>
            </div>
            <div class="ms-3">
                <button type="button" class="btn btn-outline-primary btn-sm me-2" onclick="acceptCookies()">
                    Accept
                </button>
                <button type="button" class="btn btn-outline-secondary btn-sm" data-bs-dismiss="alert">
                    Decline
                </button>
            </div>
        </div>
    </div>

    <script>
        function acceptCookies() {
            document.cookie = "@cookieString";
            document.getElementById('cookieConsent').style.display = 'none';
        }
    </script>
}